# Goby AI 智能生成未授权访问类型漏洞的PoC/EXP步骤及其构成方式

以“金和OA SAP_B1Config.aspx未授权访问漏洞”为例，我们可以先查看此漏洞细节的参考来源链接：

https://cn-sec.com/archives/2385220.html

可以看到，来源链接中，包含 漏洞名称、漏洞简介、FOFA语法、漏洞利用路径、payload请求包信息

在JSON图形化页面中,Goby PoC的模板分为三个模块，，分别为：漏洞信息、扫描测试、利用测试

当接收到文章链接或文本时，未授权访问智能体首先解析文章中的文本和图片内容，提取漏洞背景描述、请求包和响应包等关键信息。

## 提取漏洞基础信息：
漏洞名称：金和OA SAP_B1Config.aspx未授权访问漏洞

漏洞简介：金和QA办公系统是.款集合了办公自动化协同办公工作流管理等功能的企业级管理软件。金和OA办公系统提供了多个模块，包括日程管理、文件管理、邮件管理、人事管理、客户管理、项目管理等。用户可以根据自己的需求选择需要的模块进行使用。该系统存在未授权访问漏洞，攻击者可通过此漏洞获取数据库的账户密码等敏感信息。

FOFA语句：fofa语句app="金和网络-金和OA"

智能体提取到这部分信息进行自动填写，同时自动翻译英文版自动填充：
**![](https://s3.bmp.ovh/imgs/2024/12/12/3abaca448a87a90a.png)**

**![](https://s3.bmp.ovh/imgs/2024/12/12/be9c31efa4e4f819.png)**


## 提取扫描测试请求包及响应包验证条件：

智能体基于提取的请求包信息，自动生成符合 Goby 格式的 JSON 代码，并从响应包中识别状态码及具有代表性的字符串，作为PoC扫描验证条件。

**![](https://s3.bmp.ovh/imgs/2024/12/12/a30ad4c94c533906.png)**

需要注意的是：由于参考文章中缺少响应包信息， 智能体从请求包中提取到了关键信息“200”并进行全文关键词分析，智能分析并填写响应包验证条件(本文中Goby AI 智能分析出 Body中可能包含“Database")。

**![](https://s3.bmp.ovh/imgs/2024/12/13/aab48d0a28fc3198.png)**

在实际场景下，在文章详情中若缺少响应包信息，建议转化后进行进行人工校验。


## 定义利用测试输入方式及输出结果：

智能体会将未授权访问的 URL 替换为变量，并填充至 EXP Params 中，方便用户查看和自定义输入访问路径。

**![](https://s3.bmp.ovh/imgs/2024/12/12/99b5df8e8859845c.png)**
**![](https://s3.bmp.ovh/imgs/2024/12/12/d54300ea528139d4.png)**

同时，智能体会在验证结果展示框中输出未授权访问的完整地址，提供两个输出信息：

1.未授权访问的地址：用户可直接访问以查看泄露的数据库账号和密码。

2.网页原文：通过正则提取网页原文展示信息，便于后续验证和分析。

**![](https://s3.bmp.ovh/imgs/2024/12/12/144cc71adce137d8.png)**


# 实战检验: 金和OA SAP_B1Config.aspx 未授权访问漏洞

输入靶场目标进行扫描，确认扫描测试准确性：√

**![](https://s3.bmp.ovh/imgs/2024/12/12/7cc3d0ca4af5fcf3.png)**

点击验证，检测输出信息的准确性：√
**![](https://s3.bmp.ovh/imgs/2024/12/13/4c5ce965cc254fc3.png)**


## GobyAI 智能生成未授权访问类型漏洞完整流程演示效果如下：

**![](https://s3.bmp.ovh/imgs/2024/12/13/dcc9d802eeb4fbca.gif)**


