# Goby AI 如何智能生成SQL注入型漏洞的PoC/EXP步骤及其构成方式
GobyAI通过生成JSON代码就能够把SQL注入漏洞的各种EXP验证效果完整实现，在介绍具体的EXP代码之前，需要先了解一下我们的ExpParams参数的运行逻辑，这决定了最终我们将发送何种Payload来进行EXP验证。
EXPParams:

**![](https://s3.bmp.ovh/imgs/2024/11/22/645918494da79f84.webp)**
在Goby的漏洞框架中，我们通过一个参数数组，来传递具体的漏洞验证效果，首先通过 attackType 指定所有可用的验证方式，然后使用 attackType=xxx 切换至对应的验证方式。在每种验证方式中，用户可以进一步定义具体的验证效果，以满足不同场景的需求。也由于EXPParams的过于灵活，导致在原有漏洞框架中，无法对复杂的EXPParams进行处理，其难点主要有两个：

1.如何根据传入的EXPParams来发送不同的Payload

2.如何根据不同的EXPParams来回显不同的数据
所以在新的漏洞框架中，我们新增了多种语法以增强漏洞验证的灵活性与执行能力：

switch :

为了解决第一个问题，我们提供了新的函数关键字，切换不同的漏洞验证方式。例如，以 SQL 注入为例，通常支持三种验证方式：默认方式、用户输入方式和 sqlpoint 方式。通过 switch 关键字，可以灵活选择当前需要使用的验证方式，从而便于后续编码及相关操作的实现。

如下图所示，会根据attackType的传值来定义不同的Payload。
**![](https://s3.bmp.ovh/imgs/2024/11/22/168d44bf08be101c.webp)**

when:

同样，解决Payload问题之后，我们需要解决第二个问题，when 关键字用于对输出内容进行控制，在 SQL 注入的 EXP 中，当attackType为sqlPoint的时候，我们需要打印发送的请求数据包，以便于用户提取数据包用于后续的检测。
**![](https://s3.bmp.ovh/imgs/2024/11/22/b9e6f8fe0e91ab6c.webp)**



在 SQL 注入智能体中，当接收到漏洞参考文本时，智能体首先识别数据库类型并生成相应的 SQL 验证命令，同时定位 SQL 命令的位置，并将其替换为相应的变量。智能体会根据漏洞特性，灵活选择 switch 和 when 关键字，并判断是否需要进行编码处理。编写完成后，智能体将生成的 EXP 文件反馈至监管智能体进行审核确认，审核通过后输出最终的 EXP 文件。

# GobyAI的实战检验: Supabase 后端服务平台 SQL注入漏洞
通过公开参考信息的描述查看漏洞成因：Supabase 后端服务平台/api/pg:meta/defaultguery对用户传入的数据没有进行校验和过滤，导致攻击者传入的SQL语句直接带入到数据库执行，形成SQL注入，可获取数据库敏感信息，深入利用可获取服务器权限。
以下是AI Bot的实战检验流程：
1.采集漏洞细节参考链接 https://blog.csdn.net/qq_41904294/article/details/135443624

2.自动采集补全信息：AI引擎将迅速解析链接内容并提取图片内容，将解析到的内容分发到不同的子任务（以实现快速解析）；√
提取到漏洞类型为【SQL注入】，并提取分析payload；√

3.分配SQL注入漏洞类型智能体并解析数据库类型；√

4.自动生成符合Goexp规范的PoC/EXP代码，代码包含:Payload请求参数、验证环节的数据库SQL执行语句、执行方式等；√
**![](https://s3.bmp.ovh/imgs/2024/11/22/3dc44275c8549c71.webp)**

5.一键检测：输入靶场环境目标，准确无误检测出目标是否存在漏洞；√
**![](https://s3.bmp.ovh/imgs/2024/11/22/7e1e51bdd3c32b33.webp)**

6.一键验证：点击验证，通过自动生成的SQL执行语句准确输出output信息。√
**![](https://s3.bmp.ovh/imgs/2024/11/22/0d3d2c10c40ac2db.webp)**
